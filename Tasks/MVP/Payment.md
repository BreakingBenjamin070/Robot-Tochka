# UserStory Оплата заказа

## US 01: Я как посетитель ХОЧУ оплатить заказ бонусными баллами ЧТОБЫ потратить меньше денег
### Acceptance Criteria 
- Пользователь может выбрать метод оплаты «Бонусные баллы» при оформлении заказа
- Если у пользователя есть баллы, то сумма к оплате уменьшается на эквивалентную сумму баллов
- После оплаты баллами, баланс баллов должен уменьшиться на эквивалентную сумму
### Tasks
1. Создать логику для оплаты заказа бонусными баллами
> Реализовать проверку наличия бонусных баллов и расчет списания суммы
2. Реализовать UI для выбора метода оплаты «Бонусные баллы»
> Добавить опцию «Бонусные баллы» на экране оплаты с отображением текущего баланса баллов.
### TestCase
**Позитивные сценарии:**
 - Оплата заказa бонусными баллами:
 > Пользователь оформляет заказ и выбирает метод оплаты «Бонусные баллы»  
*Ожидаемый результат:* Сумма к оплате уменьшается на эквивалентную сумму баллов, баланс баллов уменьшается на потраченное количество

**Негативные сценарии:**
- Недостаточно баллов для оплаты заказа:
> Пользователь пытается оплатить заказ, не имея достаточного количества баллов.    
*Ожидаемый результат:* Система выводит сообщение об ошибке, указывая, что баллов недостаточно для полной оплаты



## US 02: Я как Посетитель ХОЧУ оплатить заказ по СБП ЧТОБЫ получить свою еду
### Acceptance Criteria 
- После завершения выбора блюд пользователь должен быть перенаправлен на страницу оплаты, где будет доступен единственный способ оплаты — с помощью карты через систему быстрых платежей (СБП).
- Система должна предложить пользователю сгенерировать QR-код для оплаты или выполнить оплату через приложение банка, поддерживающее СБП.
- После успешной оплаты заказ должен быть автоматически переведен в статус "Оплачен", и на экране подтверждения заказа должно быть отображено сообщение об успешной транзакции.
- Если по каким-либо причинам оплата не была завершена, система должна запросить повторную попытку или предложить пользователю помощь в случае возникновения проблем.
### Tasks
1.	Реализовать переход на страницу оплаты с поддержкой СБП
> После оформления заказа пользователь перенаправляется на страницу оплаты, где генерируется QR-код для системы быстрых платежей (СБП). QR-код должен соответствовать сумме заказа и содержать все необходимые данные для проведения транзакции.
2.	Реализовать проверку успешности оплаты через СБП
> После того как пользователь произвел оплату через СБП, система должна проверить статус транзакции. В случае успешной оплаты заказ должен перейти в статус "Оплачен", и пользователю должно быть показано подтверждение.
3.	Реализовать повторную попытку оплаты в случае ошибки
> Если по какой-либо причине оплата не удалась, пользователь должен получить сообщение об ошибке и возможность повторить оплату. Система должна повторно сгенерировать QR-код и предложить пользователю завершить оплату, пока заказ не будет подтвержден как "Оплачен".
### TestCase
**Позитивный сценарий:**
1.	Пользователь завершает выбор блюд и переходит к оплате.
2.	Система перенаправляет пользователя на страницу оплаты, где отображается возможность оплаты через СБП.
3.	Пользователь успешно завершает оплату.

*Ожидаемый результат:* Пользователь перенаправляется на страницу оплаты, успешно оплачивает заказ через СБП, и заказ переходит в статус "Оплачен".

**Негативные сценарии:**
- Отсутствие перенаправления на страницу оплаты:
> Пользователь завершает выбор блюд, но не перенаправляется на страницу оплаты из-за сбоя.  
*Ожидаемый результат: *Пользователь получает сообщение об ошибке и возможность повторной попытки.
- Ошибка на странице оплаты:
> Пользователь переходит на страницу оплаты, но система не отображает опцию оплаты через СБП (пустая страница).  
*Ожидаемый результат:* Система выводит сообщение об ошибке и предлагает пользователю альтернативные действия или повторную загрузку страницы.
- Неуспешная транзакция через СБП:
> Пользователь вводит данные для оплаты через СБП, но транзакция завершается ошибкой (например, недостаточно средств или ошибка сервера).  
*Ожидаемый результат:* Пользователь получает уведомление о неуспешной транзакции и возможность повторной попытки оплаты.
